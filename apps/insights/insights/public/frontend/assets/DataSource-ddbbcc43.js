var h=(p,b,r)=>new Promise((e,i)=>{var c=a=>{try{u(r.next(a))}catch(t){i(t)}},f=a=>{try{u(r.throw(a))}catch(t){i(t)}},u=a=>a.done?e(a.value):Promise.resolve(a.value).then(c,f);u((r=r.apply(p,b)).next())});import{I as k}from"./IndicatorIcon-7b530cb8.js";import{L as C}from"./ListView-7e5cf52e.js";import{P as T}from"./PageBreadcrumbs-e38fbd0a.js";import{aB as B,D as V,r as w,f as D,i as N,M as _,x as $,N as d,L as s,z as n,H as l,F as I,v as q,a5 as v,aI as z,aJ as g,O as S,A}from"./frappe-ui-24524c82.js";import{u as E}from"./useDataSource-327864e5.js";import"./index-45270e13.js";import"./index-61e7aa99.js";import"./cacheStore-8d74b582.js";const R={class:"sticky top-0 z-10 flex items-center justify-between bg-white px-5 py-2.5"},j=d("div",{class:"text-xl font-medium"},"No tables.",-1),F=d("div",{class:"mt-1 text-base text-gray-600"},"No tables to display.",-1),W={__name:"DataSource",props:{name:{type:String,required:!0}},setup(p){const b=p,r=B(),e=E(b.name);V("dataSource",e),e.fetchTables();const i=w("");D(()=>i.value?e.tableList.filter(t=>!t.is_query_based&&t.label.toLowerCase().includes(i.value.toLowerCase())):e.tableList.filter(t=>!t.is_query_based));const c=w(!1),f=D(()=>[{label:"Sync Tables",icon:"refresh-cw",onClick:a},{label:"Delete",icon:"trash",onClick:()=>c.value=!0}]),u=N("$notify");function a(){e.syncTables().catch(t=>u({title:"Error Syncing Tables",variant:"error"}))}return(t,m)=>{const y=_("Button"),x=_("Dropdown"),L=_("Dialog");return q(),$(I,null,[d("header",R,[s(T,{class:"h-7",items:[{label:"Data Sources",route:{path:"/data-source"}},{label:n(e).doc.title}]},null,8,["items"])]),s(C,{columns:[{label:"Table",name:"label"},{label:"Status",name:"status"}],rows:n(e).tableList.filter(o=>!o.is_query_based)},{actions:l(()=>[s(y,{variant:"outline",iconLeft:"link-2",onClick:m[0]||(m[0]=o=>t.$router.push(`/data-source/${n(e).doc.name}/relationships`))},{default:l(()=>[v(" Manage Relationships ")]),_:1}),s(x,{placement:"left",button:{icon:"more-horizontal",variant:"outline"},options:f.value},null,8,["options"])]),"list-row":l(({row:o})=>[s(n(z),{as:"router-link",row:o,to:{name:"DataSourceTable",params:{name:n(e).doc.name,table:o.name}}},{default:l(()=>[s(n(g),null,{default:l(()=>[v(S(o.label),1)]),_:2},1024),s(n(g),{class:"space-x-2"},{default:l(()=>[s(k,{class:A(o.hidden?"text-gray-500":"text-green-500")},null,8,["class"]),d("span",null,S(o.hidden?"Disabled":"Enabled"),1)]),_:2},1024)]),_:2},1032,["row","to"])]),emptyState:l(()=>[j,F,s(y,{class:"mt-4",label:"Sync Tables",variant:"solid",onClick:a})]),_:1},8,["rows"]),s(L,{modelValue:c.value,"onUpdate:modelValue":m[1]||(m[1]=o=>c.value=o),dismissable:!0,options:{title:"Delete Data Source",message:"Are you sure you want to delete this data source?",icon:{name:"trash",appearance:"danger"},actions:[{label:"Delete",variant:"solid",theme:"red",onClick:()=>h(this,null,function*(){yield n(e).delete(),n(r).push({name:"DataSourceList"})})}]}},null,8,["modelValue","options"])],64)}}};export{W as default};
